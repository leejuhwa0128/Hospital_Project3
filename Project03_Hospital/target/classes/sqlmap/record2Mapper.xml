<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.hospital.mapper.Record2Mapper">

    <select id="getRecordsByDoctorId" parameterType="string"
        resultType="com.hospital.vo.MedicalRecordVO">
        SELECT
        mr.*,
        p.patient_name AS patientName
        FROM medical_records mr
        JOIN reservations r ON mr.reservation_id = r.reservation_id
        JOIN patients p ON r.patient_no = p.patient_no
        WHERE mr.doctor_id = #{doctorId}
        ORDER BY mr.record_date DESC
    </select>

    <update id="updateRequestedStatus" parameterType="map">
        UPDATE medical_records
        SET requested = #{requested}
        WHERE record_id = #{recordId}
    </update>
</mapper>